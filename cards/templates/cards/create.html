{% extends 'cards/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É - –ü–ê–†–¢–ú–ê–†–¢{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <h1 class="text-4xl font-bold mb-8 text-center bg-gradient-to-r from-red-500 to-orange-500 bg-clip-text text-transparent">
        ‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É
    </h1>
    
    <div class="glass-panel p-8 rounded-2xl">
        <form method="post" enctype="multipart/form-data" id="createForm">
            {% csrf_token %}
            
            <!-- –§–æ—Ç–æ -->
            <div class="mb-8">
                <label class="block text-lg font-bold mb-3">üì∏ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è –ü–ö</label>
                <div id="dropZone" class="border-2 border-dashed border-gray-600 rounded-xl p-12 text-center hover:border-red-500 transition-all duration-300 cursor-pointer">
                    <p class="text-gray-400 mb-2">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ —Å—é–¥–∞ –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</p>
                    <p class="text-sm text-gray-500">PNG, JPG –¥–æ 10MB</p>
                    {{ form.photo }}
                </div>
                <div id="preview" class="mt-4 hidden">
                    <img id="previewImg" class="max-w-full h-64 object-cover rounded-xl mx-auto">
                </div>
            </div>
            
            <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ -->
            <div class="glass-card p-6 rounded-xl mb-6">
                <h3 class="text-xl font-bold mb-4">üíª –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">üñ• –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä</label>
                        {{ form.cpu }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">üéÆ –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞</label>
                        {{ form.gpu }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">üß† –û–ø–µ—Ä–∞—Ç–∏–≤–∫–∞</label>
                        {{ form.ram }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">üíæ –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å</label>
                        {{ form.storage }}
                    </div>
                </div>
            </div>
            
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã -->
            <div class="glass-card p-6 rounded-xl mb-6">
                <h3 class="text-xl font-bold mb-4">üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">–ú–∞—Ç. –ø–ª–∞—Ç–∞</label>
                        {{ form.motherboard }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">–ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è</label>
                        {{ form.psu }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">–ö–æ—Ä–ø—É—Å</label>
                        {{ form.case }}
                    </div>
                </div>
            </div>
            
            <!-- –¶–µ–Ω–∞ –∏ –±–æ–Ω—É—Å—ã -->
            <div class="glass-card p-6 rounded-xl mb-6">
                <h3 class="text-xl font-bold mb-4">üí∞ –¶–µ–Ω–∞ –∏ –±–æ–Ω—É—Å—ã</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-semibold mb-2">üíµ –¶–µ–Ω–∞ (‚ÇΩ)</label>
                        {{ form.price }}
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">üéÅ –ë–æ–Ω—É—Å—ã</label>
                        {{ form.bonuses }}
                    </div>
                </div>
            </div>
            
            <!-- –í—ã–±–æ—Ä —Å—Ç–∏–ª—è -->
            <div class="glass-card p-6 rounded-xl mb-8">
                <h3 class="text-xl font-bold mb-4">üé® –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å –∫–∞—Ä—Ç–æ—á–∫–∏</h3>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    {% for value, label in form.style.field.choices %}
                    <label class="style-option glass-card p-4 rounded-xl text-center cursor-pointer hover-glow transition-all duration-300">
                        <input type="radio" name="style" value="{{ value }}" {% if forloop.first %}checked{% endif %} class="hidden">
                        <div class="text-3xl mb-2">
                            {% if value == 'msi' %}üî¥
                            {% elif value == 'steam' %}üéÆ
                            {% elif value == 'apple' %}üçé
                            {% elif value == 'spotify' %}üéµ
                            {% endif %}
                        </div>
                        <div class="font-bold">{{ label }}</div>
                    </label>
                    {% endfor %}
                </div>
            </div>
            
            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="flex gap-4 justify-center">
                <button type="submit" class="steam-button text-lg px-8 py-3">
                    ‚ú® –°–æ–∑–¥–∞—Ç—å —Å–±–æ—Ä–∫—É
                </button>
                <a href="{% url 'cards:index' %}" class="steam-button-secondary text-lg px-8 py-3">
                    ‚ùå –û—Ç–º–µ–Ω–∞
                </a>
            </div>
        </form>
    </div>
</div>

<style>
.style-option input:checked + div {
    transform: scale(1.1);
}
.style-option:has(input:checked) {
    border: 2px solid #ef4444;
    box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
}
#id_photo {
    display: none;
}
</style>

<script>
const dropZone = document.getElementById('dropZone');
const fileInput = document.getElementById('id_photo');
const preview = document.getElementById('preview');
const previewImg = document.getElementById('previewImg');

dropZone.addEventListener('click', () => fileInput.click());

dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.classList.add('border-red-500');
});

dropZone.addEventListener('dragleave', () => {
    dropZone.classList.remove('border-red-500');
});

dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.classList.remove('border-red-500');
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
        fileInput.files = files;
        showPreview(files[0]);
    }
});

fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
        showPreview(e.target.files[0]);
    }
});

function showPreview(file) {
    const reader = new FileReader();
    reader.onload = (e) => {
        previewImg.src = e.target.result;
        preview.classList.remove('hidden');
    };
    reader.readAsDataURL(file);
}
</script>
{% endblock %}
