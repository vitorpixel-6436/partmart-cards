{% extends 'cards/base.html' %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É | –ü–ê–†–¢–ú–ê–†–¢{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Header -->
    <div class="glass-panel rounded-3xl p-8 mb-8 text-center">
        <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
        </h1>
        <p class="text-gray-300">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ü–ö –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</p>
    </div>
    
    <!-- Presets Quick Select -->
    {% if presets %}
    <div class="glass-dark rounded-2xl p-6 mb-8">
        <h3 class="text-xl font-bold mb-4">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
            {% for preset in presets %}
            <button onclick="loadPreset('{{ preset.pk }}')"
                    class="glass-light rounded-xl p-3 hover:bg-blue-500/20 text-sm">
                {{ preset.name }}
            </button>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Form -->
    <form method="post" enctype="multipart/form-data" class="space-y-6">
        {% csrf_token %}
        
        <!-- Photo Upload -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="text-2xl font-bold mb-4">üì∏ –§–æ—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</h3>
            <div id="drop-zone" class="glass-dark rounded-xl p-12 text-center border-2 border-dashed border-gray-600 hover:border-blue-400 cursor-pointer">
                <div class="text-6xl mb-4">üìÅ</div>
                <p class="text-xl mb-2">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ —Å—é–¥–∞</p>
                <p class="text-gray-400 mb-4">–∏–ª–∏</p>
                {{ form.photo }}
                <label for="id_photo" class="steam-btn px-6 py-3 rounded-xl cursor-pointer inline-block">
                    –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
                </label>
            </div>
            <div id="preview" class="mt-4"></div>
        </div>
        
        <!-- Main Specs -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="text-2xl font-bold mb-6">‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">üñ• –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä</label>
                    {{ form.cpu }}
                </div>
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">üéÆ –í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞</label>
                    {{ form.gpu }}
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-300">üß† –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å</label>
                        {{ form.ram }}
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-300">üíæ –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å</label>
                        {{ form.storage }}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Additional Components -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="text-2xl font-bold mb-6">üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">üîå –ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞</label>
                    {{ form.motherboard }}
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-300">‚ö° –ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è</label>
                        {{ form.psu }}
                    </div>
                    <div>
                        <label class="block text-sm font-bold mb-2 text-gray-300">üì¶ –ö–æ—Ä–ø—É—Å</label>
                        {{ form.case }}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Price & Bonuses -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="text-2xl font-bold mb-6">üí∞ –¶–µ–Ω–∞ –∏ –±–æ–Ω—É—Å—ã</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">üíµ –¶–µ–Ω–∞ (‚ÇΩ)</label>
                    {{ form.price }}
                </div>
                <div>
                    <label class="block text-sm font-bold mb-2 text-gray-300">üéÅ –ë–æ–Ω—É—Å—ã</label>
                    {{ form.bonuses }}
                </div>
            </div>
        </div>
        
        <!-- Style Selection -->
        <div class="glass-panel rounded-2xl p-8">
            <h3 class="text-2xl font-bold mb-6">üé® –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∏–ª—å –∫–∞—Ä—Ç–æ—á–∫–∏</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                {% for value, label in form.style.field.choices %}
                <label class="glass-light rounded-xl p-6 cursor-pointer hover:bg-blue-500/20 flex items-center space-x-4">
                    <input type="radio" name="style" value="{{ value }}" 
                           {% if form.style.value == value or forloop.first and not form.style.value %}checked{% endif %}
                           class="w-5 h-5">
                    <div>
                        <div class="text-2xl mb-1">{{ label }}</div>
                        <div class="text-sm text-gray-400">
                            {% if value == 'msi' %}–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π gaming –¥–∏–∑–∞–π–Ω
                            {% elif value == 'steam' %}Glass morphism —ç—Ñ—Ñ–µ–∫—Ç—ã
                            {% elif value == 'apple' %}–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π premium
                            {% elif value == 'spotify' %}–£–ª—å—Ç—Ä–∞-—á–∏—Å—Ç—ã–π —Å—Ç–∏–ª—å
                            {% endif %}
                        </div>
                    </div>
                </label>
                {% endfor %}
            </div>
        </div>
        
        <!-- Submit -->
        <div class="flex space-x-4">
            <button type="submit" class="spotify-btn flex-1 py-5 rounded-xl font-bold text-xl">
                üöÄ –°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
            </button>
            <a href="{% url 'cards:index' %}" class="glass-light px-8 py-5 rounded-xl font-bold text-xl text-center">
                –û—Ç–º–µ–Ω–∞
            </a>
        </div>
    </form>
</div>

<style>
    input[type="text"],
    input[type="number"],
    textarea {
        width: 100%;
        padding: 12px 16px;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        color: white;
        font-size: 16px;
    }
    
    input[type="text"]:focus,
    input[type="number"]:focus,
    textarea:focus {
        outline: none;
        border-color: rgba(59, 130, 246, 0.5);
        background: rgba(255, 255, 255, 0.08);
    }
    
    input[type="file"] {
        display: none;
    }
</style>

<script>
    // Drag & Drop
    const dropZone = document.getElementById('drop-zone');
    const fileInput = document.getElementById('id_photo');
    const preview = document.getElementById('preview');
    
    dropZone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropZone.style.borderColor = '#3b82f6';
    });
    
    dropZone.addEventListener('dragleave', () => {
        dropZone.style.borderColor = '#4b5563';
    });
    
    dropZone.addEventListener('drop', (e) => {
        e.preventDefault();
        dropZone.style.borderColor = '#4b5563';
        
        const files = e.dataTransfer.files;
        if (files.length) {
            fileInput.files = files;
            showPreview(files[0]);
        }
    });
    
    fileInput.addEventListener('change', (e) => {
        if (e.target.files.length) {
            showPreview(e.target.files[0]);
        }
    });
    
    function showPreview(file) {
        const reader = new FileReader();
        reader.onload = (e) => {
            preview.innerHTML = `<img src="${e.target.result}" class="rounded-xl max-h-64 mx-auto">`;
        };
        reader.readAsDataURL(file);
    }
</script>
{% endblock %}
